         MACRO
         VTCCOM  &TYPE
.*  MODIFICATIONS
.* IDENTIFIER   DATE   PERSON       REMARKS
.*    001G     030379  GATES        ADD LOGIC FOR PURGE KEYWORD.
.*    002G     110883  GATES        ADD LOGIC FOR MAP ROUTINE.
.*    003G     112383  GATES        REDEFINE VALUES FOR VTCPFUNC.
.*    004G     050284  GATES        RENAME VTOCOM TO VTCOM TO MAKE
.*                                   VTOC MORE TRANSPORTABLE.
.*    005G     051084  GATES        ADD UNIT NAME FIELD.
.*    006G     052284  GATES        CORRECT LENGTH OF FMT3 TO 140.
.*                                  SPECIFY ENOUGH AREA FOR MAXIMUM
.*                                   FORMAT 3 DSCBS TO HANDLE 127
.*                                   EXTENTS.
.*                                  COMMENT OUT IECSDSL1 3 MACRO IT
.*                                   WILL NOW BE USED AS A DSECT WHERE
.*                                   NECESSARY.
.*    007G     111485  GATES        BUMP NUMBER OF DATASETS FROM 1024
.*                                   TO 4096 FOR MAP FUNCTION.
.*    008G     121985  GATES        BUMP NUMBER OF DATASETS FROM 1024
.*                                   TO 8192 FOR MAP FUNCTION.
.*    009G     122085  GATES        BUMP NUMBER OF BLOCKS OF STORAGE
.*                                   THAT CAN BE GETMAINED FROM 50
.*                                   TO 100.
.*    010G     041388  GATES        TAKE OUT PURGE KEYWORD LOGIC.
.*
.*
.*
*
*        THIS IS THE VTOC COMMAND COMMON AREA
*
         AIF   ('&TYPE' EQ 'NODSECT').NODSECT
VTOCOM   DSECT
         AGO   .NODS
.NODSECT ANOP
VTOCOM   DS    0D
.NODS    ANOP
*
*        WORKING STORAGE AREAS FOR THE VARIOUS ROUTINES
*
VTCWMSG  DS    A              WORKING STORAGE FOR THE MSG  ROUTINE
VTCWEXIT DS    A              WORKING STORAGE FOR THE EXIT ROUTINE
VTCWEXCP DS    A              WORKING STORAGE FOR THE EXCP ROUTINE
VTCWCHEK DS    A              WORKING STORAGE FOR THE CHEK ROUTINE
VTCWFORM DS    A              WORKING STORAGE FOR THE FORM ROUTINE
VTCWPRNT DS    A              WORKING STORAGE FOR THE PRNT ROUTINE
VTCWSORT DS    A              WORKING STORAGE FOR THE SORT ROUTINE
VTCWMAP  DS    A              WORKING STORAGE FOR THE MAP  ROUTINE 002G
*
*        ADDRESSES OF THE ROUTINES
*
VADMSG   DC    V(VTOCMSG)     ADDRESS OF THE MESSAGE ROUTINE
VADEXIT  DC    V(VTOCEXIT)    ADDRESS OF THE EXIT ROUTINE
VADEXCP  DC    V(VTOCEXIT)    ADDRESS OF THE EXCP ROUTINE
VADCHEK  DC    V(VTOCEXIT)    ADDRESS OF THE CHECK ROUTINE
VADFORM  DC    V(VTOCEXIT)    ADDRESS OF THE FORMAT ROUTINE
VADPRNT  DC    V(VTOCEXIT)    ADDRESS OF THE PRINT ROUTINE
VADSORT  DC    V(VTOCEXIT)    ADDRESS OF THE SORT ROUTINE
VADMAP   DC    V(VTOCEXIT)    ADDRESS OF THE MAP  ROUTINE          002G
*
*        TSO COMMAND PROCESSOR AND PARSE DATA
*
ADDRUPT  DS    A              USER PROFILE TABLE
ADDRECT  DS    A              ENVIRONMENT CONTROL TABLE
ADDRPSCB DS    A              PROTECTED STEP CONTROL BLOCK
ADDRCBUF DS    A              COMMAND BUFFER
         SPACE
ADDRANSR DS    A              PARSE ANSWER OR PDL ADDRESS
         SPACE
PARMLIST DS    8A             INTERNAL PARM AREA ( MSG )
ATTNECB  DS    F              ECB FOR ATTENTIONS
DOUBLE   DS    D
         SPACE
MSGADDRS DS    2A             ADDRESSES OF MESSAGES FOR VTOCMSG
MSGTEXT1 DS    XL124
MSGTEXT2 DS    XL124
         SPACE 3
PUTOLD1  DS    3F
PUTOLD2  DS    3F
*
*        PARAMETER LIST FOR THE EXIT ROUTINE
*
EXITLIST DS    0F
EXITAREA DS    A       WORKAREA LOCATION
DSCBADDR DS    A       ADDRESS OF THE DSCB
FORMATAD DS    A       ADDRESS OF THE FORMATTED DSCB
CPPLADDR DS    A       ADDRESS OF THE CPPL
ACTIONAD DS    A       ADDRESS OF THE RECOMMENDED OR REQUESTED ACTION
*
*        INTER ROUTINE FLAGS
*
VTCEFUNC DS    X              VTOCEXCP FUNCTION FLAG
VTCFMTCK DS    X              FORMAT IS CALLED BY CHECK RTN
VTCFMTCD EQU   X'80'          FORMAT WAS CALLED BY CHECK
VTCFMTCC EQU   X'08'          FORMAT WAS CALLED BY CHECK THIS CALL
VTCMFUNC DS    X              VTOCMAP FUNCTION FLAG                002G
VTCCFUNC DS    X              VTOCCHEK FUNCTION FLAG               002G
*
TABFULL  DS    X              FLAG TABLES FULL, STOP INPUT
LOCAT    DS    X              FLAG TO PERFORM CATALOG LOCATE
*VOLPORS  DS    X         FLAG TO INDICATE VOLUME PUBL OR STOR 001G010G
VTCPFUNC DS    X              PRINT END/CLEANUP AND MAP FLAG.      002G
*                              X'00' INDICATES DSN HEADINGS REQ'D. 003G
*                              X'01' INDICATES MAP HEADINGS REQ'D. 003G
*                              X'02' INDICATES NO  HEADINGS REQ'D. 003G
*                              X'04' AVAILABLE.                    003G
*                              X'08' INDICATES CLEANUP REQ'D.      003G
DSNLEN   DS    H              LENGTH OF THE DSNAME (NON-BLANKS)
ATABTITL DS    A              ADDRESS OF TABLE OF TITLES, LENGTHS
*
*
*
*        WORKING STORAGE FOR VOLUME UCB SEARCH
*
ADDR     DS    CL3     UCB ADDRESS IN CHARACTERS
VOLSER   DS    CL6     VOLUME SERIAL NUMBER FROM PARSE
VOLID    DS    CL6     CURRENT VOLUME SERIAL NUMBER TO PROCESS
UNITYP   DS    CL6     UNIT TYPE                                  005G
FLAG     DS    X       UCB SEARCH FLAG
LASTADR  DS    F       LAST UCB ADDRESS FOUND ( NO DUP'S )
*
*
*
*        ADDRESSES OF GETMAIN FOR FORMATTED DATA
*
VTCCURAD DS    A             CURRENT AVAILABLE ADDRESS
VTCCURLN DS    A             CURRENT AVAILABLE LENGTH
*VTCGETMN DS    50A           ADDRESSES OF BLOCKS                  009G
VTCGETMN DS    100A          ADDRESSES OF BLOCKS                   009G
VTCGETMX EQU  (*-VTCGETMN)/4  NUMBER OF BLOCKS  MAXIMUM
VTCGETMS EQU   32768          GETMAIN SIZE
*
*
*
*        ADDRESSES OF GETMAIN FOR MAPPING VOLUMES
*
VTCMPMEM DS    A             BEGINNING OF VOLUME MAP AREA.         002G
VTCMPEXT DS    A             CURRENT AVAILABLE EXTENT SAVE ADDRESS.002G
VTCMPDSN DS    A             CURRENT AVAILABLE DSNAME SAVE ADDRESS.002G
VTCMPGET EQU   128*8192      GETMAIN SIZE FOR 4096     002G  007G 008G
*                             DATASETS OF 128 EXTENTS.       007G 008G
*
*        HASH SORT TABLE, POINTERS TO FIRST ENTRIES
*
VTCSORTH DS    256A           POINT TO FORMATED ENTRIES
VTCSORTE EQU   *              END OF LIST
*
*        PRINT ENTRIES - PAGE AND LINE COUNTERS
*
LINECT   DS    H              LINE COUNT
LINEMAX  DS    H              MAXIMUM LINES PER PAGE
PAGECT   DS    H              PAGE COUNT
LINELEN  DS    H              LENGTH OF THE PRINT LINE
*
*
*          VARIOUS ITEMS
*
FMT4     DS    XL44           SPACE FOR DSCB NAME
         IECSDSL1 4          SAVE EACH FORMAT 4 DSCB
         DS    0D
*MT3     DS    0XL148         SPACE FOR FORMAT3 DSCB               006G
*        IECSDSL1 3                                                006G
FMT3     DS    1XL130         SPACE FOR FORMAT3 DSCB EXT   4-16    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  17-29    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  30-42    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  43-55    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  56-68    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  69-81    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  82-94    006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT  95-107   006G
         DS    1XL130         SPACE FOR FORMAT3 DSCB EXT 108-120   006G
         DS    1XL140         SPACE FOR FORMAT3 DSCB EXT 121-127   006G
*                              LAST ENTRY MUST BE 140 BYTES.       006G
FMT3LEN  EQU   *-FMT3         LENGTH FOR CLEARING.                 006G
         DS    0D
         MEND
